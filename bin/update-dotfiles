#!/usr/bin/env bash

# shellcheck source=./helpers/setup.sh
. "$(dirname "$0")/../helpers/setup.sh"

log_info "➡️  Updating $DOTFILES"

# We first pull the dotfiles repo to get the updated install.py
git -C "$DOTFILES" pull

log_info "➡️  Running $DOTFILES/install.py"
python3 "$DOTFILES/install.py"

# Update cheatsheet submodule
(cd "$DOTFILES" && git submodule update --remote --merge config/cheat)

# Install prek hooks
if command -v prek &> /dev/null; then
    (cd "$DOTFILES" && prek install)
else
    log_info "⚠️  prek not found, skipping prek install"
fi

log_info "✅ Updated $DOTFILES"
